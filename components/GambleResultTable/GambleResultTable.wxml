<view class="gamble-result-table">
  <view class="table-container" style="width: 100%; min-width: 100%;">
    <!-- 表头 -->
    <view class="table-header">
      <view class="header-cell hole-header">
        <text>洞</text>
      </view>
      <view
        class="header-cell player-header"
        wx:for="{{players}}"
        wx:key="userid"
        wx:for-item="player"
        wx:for-index="index"
      >
        <view class="player-info">
          <image
            wx:if="{{player.cover}}"
            class="player-avatar"
            src="{{player.cover}}"
            mode="aspectFill"
          ></image>
          <view class="player-name" style="font-size: 20rpx; max-width: 100%;">{{player.nickname}}</view>
        </view>
      </view>
    </view>

    <!-- 洞数据行 -->
    <view class="table-body">
      <view class="table-row" wx:for="{{processedHoles}}" wx:key="index">
        <view class="cell hole-header">
          <view class="hole-header-inner">
            <text wx:if="{{item.draw === 'y'}}" title="平局">{{item.holename || item.id}}❓</text>
            <text wx:else>{{item.holename || item.id}}</text>
          </view>
        </view>
        <view
          class="{{item.playerClasses[player.userid] || 'cell'}}"
          wx:for="{{players}}"
          wx:key="userid"
          wx:for-item="player"
          wx:for-index="index"
        >
          <text
            class="{{item.holeMoney[player.userid] > 0 ? 'money-positive' : item.holeMoney[player.userid] < 0 ? 'money-negative' : 'money-zero'}}"
          >{{item.holeMoney[player.userid] > 0 ? '+' : ''}}{{item.holeMoney[player.userid]}}</text>
        </view>
      </view>
    </view>

    <!-- 总计行 -->
    <view class="table-row total-row">
      <view class="cell hole-header">
        <text>总成绩</text>
      </view>
      <view
        class="cell"
        wx:for="{{players}}"
        wx:key="userid"
        wx:for-item="player"
        wx:for-index="index"
      >
        <text
          class="{{totalMoney[player.userid] > 0 ? 'money-positive' : totalMoney[player.userid] < 0 ? 'money-negative' : 'money-zero'}}"
        >{{totalMoney[player.userid] > 0 ? '+' : ''}}{{totalMoney[player.userid]}}</text>
      </view>
    </view>

    <!-- 锅汇总行 -->
    <view class="table-row total-row">
      <view class="cell hole-header">
        <text>总锅</text>
      </view>
      <view
        class="cell"
        wx:for="{{players}}"
        wx:key="userid"
        wx:for-item="player"
        wx:for-index="index"
      >
        <text
          class="{{totalDonated[player.userid] > 0 ? 'money-positive' : totalDonated[player.userid] < 0 ? 'money-negative' : 'money-zero'}}"
        >{{totalDonated[player.userid] > 0 ? '+' : ''}}{{totalDonated[player.userid]}}</text>
      </view>
    </view>
  </view>
</view>
