<!-- 包洞规则配置组件 -->
<!-- 显示部分 -->
<view class="rule-section" wx:if="{{!visible}}">
  <view class="form-label">包洞规则</view>
  <view class="form-select" bindtap="onShowConfig">
    <!-- 使用view模拟input，避免真机上的光标问题 -->
    <view class="form-input-simulator">{{displayValue}}</view>
    <view class="select-arrow">
      <text class="arrow-circle">▼</text>
    </view>
  </view>
</view>

<!-- 弹窗部分 -->
<view class="modal-mask" wx:if="{{visible}}" bindtap="onCancel">
  <view class="modal-content" catchtap="noTap">
    <view class="modal-title">包洞规则</view>
    <view class="modal-list">
      <!-- 包洞规则选项 -->
      <view class="rule-section">
        <view class="rule-options">
          <view
            class="rule-option {{holeRuleType === 'no_hole' ? 'selected' : ''}}"
            bindtap="onHoleRuleChange"
            data-type="no_hole"
          >
            <view class="radio-dot {{holeRuleType === 'no_hole' ? 'selected' : ''}}"></view>
            <text class="rule-text">不包洞</text>
          </view>
          <view
            class="rule-option {{holeRuleType === 'double_par_plus_x' ? 'selected' : ''}}"
            bindtap="onHoleRuleChange"
            data-type="double_par_plus_x"
          >
            <view class="radio-dot {{holeRuleType === 'double_par_plus_x' ? 'selected' : ''}}"></view>
            <text class="rule-text">双帕+</text>
            <picker
              class="number-picker"
              range="{{doubleParPlusRange}}"
              value="{{doubleParPlusValue}}"
              bindchange="onDoubleParPlusChange"
              disabled="{{holeRuleType !== 'double_par_plus_x'}}"
            >
              <text class="picker-value">{{doubleParPlusValue}}</text>
            </picker>
            <text class="rule-text">包洞</text>
          </view>
          <view
            class="rule-option {{holeRuleType === 'par_plus_x' ? 'selected' : ''}}"
            bindtap="onHoleRuleChange"
            data-type="par_plus_x"
          >
            <view class="radio-dot {{holeRuleType === 'par_plus_x' ? 'selected' : ''}}"></view>
            <text class="rule-text">帕+</text>
            <picker
              class="number-picker"
              range="{{parPlusRange}}"
              value="{{parPlusValue}}"
              bindchange="onParPlusChange"
              disabled="{{holeRuleType !== 'par_plus_x'}}"
            >
              <text class="picker-value">{{parPlusValue}}</text>
            </picker>
            <text class="rule-text">包洞</text>
          </view>
          <view
            class="rule-option {{holeRuleType === 'stroke_diff_x' ? 'selected' : ''}}"
            bindtap="onHoleRuleChange"
            data-type="stroke_diff_x"
          >
            <view class="radio-dot {{holeRuleType === 'stroke_diff_x' ? 'selected' : ''}}"></view>
            <text class="rule-text">杆差</text>
            <picker
              class="number-picker"
              range="{{strokeDiffRange}}"
              value="{{strokeDiffValue - 1}}"
              bindchange="onStrokeDiffChange"
              disabled="{{holeRuleType !== 'stroke_diff_x'}}"
            >
              <text class="picker-value">{{strokeDiffValue}}</text>
            </picker>
            <text class="rule-text">包洞</text>
          </view>
        </view>
      </view>

      <!-- 分割线 -->
      <view class="modal-divider"></view>

      <!-- 包洞条件 -->
      <view class="condition-section {{holeRuleType === 'no_hole' ? 'disabled' : ''}}">
        <view class="condition-title">包洞条件</view>
        <view class="condition-options">
          <view
            class="condition-option {{holeCondition === 'PARTNET_HEADHEAD' ? 'selected' : ''}}"
            bindtap="{{holeRuleType === 'no_hole' ? 'noTap' : 'onHoleConditionChange'}}"
            data-condition="PARTNET_HEADHEAD"
          >
            <view class="radio-dot {{holeCondition === 'PARTNET_HEADHEAD' ? 'selected' : ''}}"></view>
            <text class="condition-text">同伴顶头包洞</text>
          </view>
          <view
            class="condition-option {{holeCondition === 'PARTNET_IGNORE' ? 'selected' : ''}}"
            bindtap="{{holeRuleType === 'no_hole' ? 'noTap' : 'onHoleConditionChange'}}"
            data-condition="PARTNET_IGNORE"
          >
            <view class="radio-dot {{holeCondition === 'PARTNET_IGNORE' ? 'selected' : ''}}"></view>
            <text class="condition-text">与同伴成绩无关</text>
          </view>
        </view>
      </view>
    </view>
    <view class="modal-actions">
      <button class="modal-btn cancel" bindtap="onCancel">取消</button>
      <button class="modal-btn confirm" bindtap="onConfirm">确定</button>
    </view>
  </view>
</view>
