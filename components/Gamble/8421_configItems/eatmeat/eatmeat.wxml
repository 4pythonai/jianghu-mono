<view wx:if="{{visible}}" class="modal-mask" bindtap="onCancel">
  <view class="modal-content" catchtap>
    <view class="modal-title">吃肉规则</view>
    <view class="modal-list">
      <view class="eat-row">
        <view class="eat-label">成绩</view>
        <view class="eat-label right">吃肉数量</view>
      </view>
      <block wx:for="{{eatRangeKeys}}" wx:key="index">
        <view class="eat-row">
          <view class="eat-label">{{eatRangeLabels[item]}}</view>
          <!-- 改为滚轮选择器 -->
          <picker class="eat-picker {{noKoufen ? 'disabled-picker' : ''}}" 
                  range="{{eatValueRange}}" 
                  value="{{eatingRange[item] - 1}}" 
                  data-index="{{index}}"
                  bindchange="{{noKoufen ? '' : 'onEatValueChange'}}"
                  disabled="{{noKoufen}}">
            <view class="picker-value">{{eatingRange[item]}}</view>
          </picker>
        </view>
      </block>
      <view class="modal-divider"></view>
      <view class="eat-row">肉的分值</view>
      <block wx:for="{{meatValueOptions}}" wx:key="index">
        <view class="modal-item {{noKoufen ? 'disabled' : ''}}" bindtap="{{noKoufen ? '' : 'onScoreSelect'}}" data-index="{{index}}">
          <view class="radio-outer {{scoreSelected === index ? 'checked' : ''}}">
            <view class="radio-inner" wx:if="{{scoreSelected === index}}"></view>
          </view>
          <text>{{item}}</text>
        </view>
      </block>
      <view class="modal-divider"></view>
      <view class="eat-row">肉值封顶</view>
      <block wx:for="{{topOptions}}" wx:key="index">
        <view class="modal-item {{noKoufen ? 'disabled' : ''}}" bindtap="{{noKoufen ? '' : 'onTopSelect'}}" data-index="{{index}}">
          <view class="radio-outer {{topSelected === index ? 'checked' : ''}}">
            <view class="radio-inner" wx:if="{{topSelected === index}}"></view>
          </view>
          <view class="option-content">
            <text wx:if="{{index === 0}}">{{item}}</text>
            <text wx:elif="{{index === 1 && topSelected === 1}}"></text>
            <text wx:elif="{{index === 1 && topSelected !== 1}}">{{topScoreLimit}}分封顶</text>
            
            <!-- 封顶分数选择器 -->
            <picker wx:if="{{index === 1 && topSelected === 1}}" 
                    class="score-picker" 
                    range="{{topScoreRange}}" 
                    value="{{topScoreLimit - 1}}" 
                    bindchange="onTopScoreChange">
              <view class="picker-value">{{topScoreLimit}}</view>
            </picker>
            <text wx:if="{{index === 1 && topSelected === 1}}">分封顶</text>
          </view>
        </view>
      </block>
    </view>
    <view class="modal-actions">
      <button class="modal-btn cancel" bindtap="onCancel">取消</button>
      <button class="modal-btn confirm" bindtap="onConfirm">确定保存</button>
    </view>
  </view>
</view>