<!-- 用户规则编辑页面 -->
<view class="user-rule-edit-container">
  <!-- 页面标题 -->
  <view class="page-header">
    <view class="header-title">编辑规则</view>
    <view class="header-subtitle">{{gameName}}</view>
  </view>

  <!-- 配置表单 -->
  <view class="config-form">
    <!-- 规则名称 -->
    <view class="form-section">
      <view class="form-label">规则名称</view>
      <input
        class="form-input"
        value="{{user_rulename}}"
        bindinput="onRuleNameInput"
        placeholder="请输入规则名称"
        maxlength="50"
      />
    </view>

    <!-- 配置组件区域 -->
    <view class="config-components">
      <block wx:for="{{configComponents}}" wx:key="name">
        <view class="component-wrapper">
          <view class="component-title">{{item.title}}</view>
          <!-- 动态加载配置组件 -->
          <view class="component-content">
            <!-- 4p-8421 配置组件 -->
            <block wx:if="{{gameType === '4p-8421'}}">
              <E8421Koufen
                wx:if="{{item.name === 'E8421Koufen'}}"
                id="{{item.name}}"
                mode="UserEdit"
              />
              <Draw8421 wx:if="{{item.name === 'Draw8421'}}" id="{{item.name}}" mode="UserEdit" />
              <E8421Meat wx:if="{{item.name === 'E8421Meat'}}" id="{{item.name}}" mode="UserEdit" />
            </block>

            <!-- 4p-lasi 配置组件 -->
            <block wx:elif="{{gameType === '4p-lasi'}}">
              <LasiKoufen
                wx:if="{{item.name === 'LasiKoufen'}}"
                id="{{item.name}}"
                mode="UserEdit"
              />
              <LasiKPI wx:if="{{item.name === 'LasiKPI'}}" id="{{item.name}}" mode="UserEdit" />
              <LasiRewardConfig
                wx:if="{{item.name === 'LasiRewardConfig'}}"
                id="{{item.name}}"
                mode="UserEdit"
              />
              <LasiEatmeat
                wx:if="{{item.name === 'LasiEatmeat'}}"
                id="{{item.name}}"
                mode="UserEdit"
              />
              <LasiDingDong
                wx:if="{{item.name === 'LasiDingDong'}}"
                id="{{item.name}}"
                mode="UserEdit"
              />
            </block>

            <!-- 默认配置组件 -->
            <block wx:else>
              <view class="default-config" wx:if="{{item.name === 'DefaultConfig'}}">
                <text>默认配置组件</text>
              </view>
            </block>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- 底部操作按钮 -->
  <view class="bottom-actions">
    <button class="delete-btn" bindtap="onDeleteRule" disabled="{{saving}}">删除</button>
    <button class="cancel-btn" bindtap="onCancel" disabled="{{saving}}">取消</button>
    <button
      class="save-btn"
      bindtap="onSaveRule"
      loading="{{saving}}"
      disabled="{{saving}}"
    >{{saving ? '保存中...' : '保存'}}</button>
  </view>
</view>
