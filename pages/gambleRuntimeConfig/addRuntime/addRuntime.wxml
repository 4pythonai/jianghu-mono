<view class="runtime-config-container">
  <!-- 调试信息 -->
  <view class="debug-info">
    <text>调试信息:</text>
    <text>gambleSysName: {{gambleSysName}}</text>
    <text>gambleSysName长度: {{gambleSysName.length}}</text>
    <text>indexOf结果: {{gambleSysName.indexOf('8421')}}</text>
    <text>条件结果: {{gambleSysName.indexOf('8421') !== -1}}</text>
    <text>直接比较: {{gambleSysName === '4p-lasi'}}</text>
    <text>包含8421: {{gambleSysName.includes('8421')}}</text>
    <text>needsPlayerConfig: {{needsPlayerConfig}}</text>
    <text>players: {{players.length}}人</text>
    <text>error: {{error}}</text>
    <text>loading: {{loading}}</text>
  </view>

  <!-- 错误状态 -->
  <view class="error-container" wx:if="{{error}}">
    <text class="error-text">{{error}}</text>
  </view>

  <!-- 主要内容 -->
  <view class="main-content" wx:else>
    <!-- 游戏规则摘要 -->
    <view class="section">
      <view class="section-title">游戏规则</view>
      <Summary
        gambleSysName="{{gambleSysName}}"
        players="{{players}}"
        userRule="{{userRule}}"
        bind:reselect="onReSelectRule"
      />
    </view>

    <!-- 洞范围选择 -->
    <view class="section">
      <view class="section-label">选择球洞范围</view>
      <HoleRangeSelector />
    </view>

    <view class="section" wx:if="{{needsPlayerConfig}}">
      <view class="section-label">球员指标配置</view>
      <PlayerIndicator
        players="{{players}}"
        val8421Config="{{runtimeConfig.playerIndicatorConfig}}"
        bind:change="onVal8421ConfigChange"
      />
    </view>

    <!-- 分组配置 -->
    <view class="section">
      <view class="section" wx:if="{{needsGrouping}}">
        <RedBlueConfig
          players="{{players}}"
          initialRedBlueConfig="{{runtimeConfig.red_blue_config}}"
          initialBootstrapOrder="{{runtimeConfig.bootstrap_order}}"
          bind:change="onGroupingConfigChange"
        />
      </view>
    </view>
    <!-- 排名配置 -->
    <view class="section">
      <view class="section-label">排名规则</view>
      <RankConflictResolver
        selectedConfig="{{runtimeConfig.ranking_tie_resolve_config}}"
        bind:change="onRankingConfigChange"
      />
    </view>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-buttons">
    <button class="cancel-btn" bindtap="onCancelConfig">取消</button>
    <button
      class="confirm-btn"
      bindtap="onConfirmConfig"
      loading="{{loading}}"
    >{{loading ? '保存中...' : '确认配置'}}</button>
  </view>
</view>
