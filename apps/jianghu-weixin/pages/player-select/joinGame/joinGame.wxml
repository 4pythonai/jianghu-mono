<view class="container">
  <view class="invite-card">
    <view class="card-header">
      <text class="card-title">您被邀请加入比赛</text>
    </view>
    <view class="code-section">
      <view class="section-top">
        <text class="section-label">[比赛编号]</text>
        <button class="ghost-btn" bindtap="handleCopyInvite" wx:if="{{uuid}}">复制</button>
      </view>
      <text class="code-value">{{gameid || '暂未获取邀请码'}}</text>
    </view>

    <view class="result-section" wx:if="{{joinSuccess}}">
      <text class="result-text">已成功加入比赛</text>
    </view>
    <view class="error-section" wx:if="{{joinError}}">
      <text class="error-text">{{joinError}}</text>
    </view>
    <!-- 已报名组信息 -->
    <view class="groups-section" wx:if="{{groups && groups.length > 0}}">
      <text class="groups-title">已报名组别</text>
      <view class="group-list">
        <view class="group-item" wx:for="{{groups}}" wx:key="groupid">
          <view class="group-header">
            <text class="group-name">{{item.group_name}}</text>
            <text class="group-count">{{item.user_count}}人已加入</text>
          </view>
          <view class="user-list">
            <view class="user-item" wx:for="{{item.users}}" wx:key="userid" wx:for-item="user">
              <image class="user-avatar" src="{{user.avatar}}" mode="aspectFill"></image>
              <text class="user-name">{{user.nickname}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <button
      class="primary-btn"
      bindtap="handleJoin"
      wx:if="{{uuid}}"
      loading="{{joining}}"
      disabled="{{joining || joinSuccess}}"
    >{{joinSuccess ? '已加入比赛' : '立即加入比赛'}}</button>
  </view>
  <view class="tips-card">
    <text class="tips-title">使用说明</text>
    <view class="tips-item">
      <text>1. 点击右上角“...”可转发到好友或群聊。</text>
    </view>
    <view class="tips-item">
      <text>2. 好友进入后可直接加入比赛或复制邀请码给组织者安排分组。</text>
    </view>
    <view class="tips-item">
      <text>3. 若无法打开小程序，可保存二维码或复制邀请码稍后再次加入。</text>
    </view>
  </view>
</view>
