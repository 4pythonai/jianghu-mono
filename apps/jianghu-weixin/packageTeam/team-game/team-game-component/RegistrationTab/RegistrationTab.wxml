<view class="registration-player-count">
  <text>报名总人数：{{tagMembers.length}} 人</text>
</view>
<!-- 表头 -->
<view class="registration-player-list-header">
  <view class="registration-header-index">序号</view>
  <view class="registration-header-avatar-placeholder"></view>
  <view class="registration-header-player">球员</view>
  <view class="registration-header-handicap">
    <text>{{mode === 'fee' ? '收费' : '江湖差点'}}</text>
  </view>
</view>
<!-- 分组列表 -->
<view
  wx:for="{{tagMemberGroups}}"
  wx:key="tagId"
  wx:for-item="group"
  class="registration-tag-group"
>
  <view class="registration-tag-group-header">
    <view class="registration-tag-group-dot" style="{{ 'background-color:#0a860a '  }}"></view>
    <text class="registration-tag-group-title">{{group.tagName}} ({{group.members.length}})</text>
  </view>
  <view class="registration-player-list">
    <ApplyerLists
      wx:for="{{group.members}}"
      wx:key="id"
      wx:for-item="member"
      index="{{member.tagSeq}}"
      avatar="{{member.avatar}}"
      show_name="{{member.show_name}}"
      userId="{{member.user_id}}"
      handicap="{{member.handicap}}"
      gender="{{member.gender}}"
      payed="{{member.payed || ''}}"
      pay_money="{{member.pay_money}}"
      tagId="{{member.tag_id}}"
      tagName="{{member.tagName}}"
      mode="{{mode}}"
      bindedit="handleEditMember"
      bindfee="handleFeeMember"
    />
  </view>
  <view
    wx:if="{{group.members.length === 0}}"
    class="registration-empty-state registration-tag-empty-state"
  ></view>
</view>
<!-- 空状态 -->
<view wx:if="{{tagMemberGroups.length === 0}}" class="registration-empty-state">
  <text>暂无报名人员</text>
</view>

<view wx:if="{{editVisible}}" class="edit-mask" bindtap="handleEditCancel"></view>
<view wx:if="{{editVisible}}" class="edit-sheet">
  <view class="edit-header">编辑球员</view>
  <view class="edit-field">
    <text class="edit-label">昵称</text>
    <input
      class="edit-input"
      value="{{editForm.showName}}"
      placeholder="请输入昵称"
      bindinput="handleNicknameInput"
    />
  </view>
  <view class="edit-field">
    <text class="edit-label">性别</text>
    <view class="edit-gender-options">
      <view
        class="edit-gender-option {{editForm.gender === 'male' ? 'active' : ''}}"
        data-value="male"
        bindtap="handleGenderSelect"
      >男</view>
      <view
        class="edit-gender-option {{editForm.gender === 'female' ? 'active' : ''}}"
        data-value="female"
        bindtap="handleGenderSelect"
      >女</view>
      <view
        class="edit-gender-option {{editForm.gender === 'unknown' ? 'active' : ''}}"
        data-value="unknown"
        bindtap="handleGenderSelect"
      >未知</view>
    </view>
  </view>
  <view class="edit-field">
    <text class="edit-label">当前分队</text>
    <text class="edit-value">{{editForm.prevTagName}}</text>
  </view>
  <view class="edit-field">
    <text class="edit-label">切换分队</text>
    <picker
      class="edit-picker"
      range="{{gameTags}}"
      range-key="tagName"
      value="{{editTagIndex}}"
      bindchange="handleTagChange"
    >
      <view class="edit-picker-value">{{editForm.newTagName || '请选择分队'}}</view>
    </picker>
  </view>
  <view class="edit-actions">
    <view class="edit-action cancel" bindtap="handleEditCancel">取消</view>
    <view class="edit-action confirm" bindtap="handleEditConfirm">确定</view>
  </view>
</view>

<view wx:if="{{feeVisible}}" class="edit-mask" bindtap="handleFeeCancel"></view>
<view wx:if="{{feeVisible}}" class="edit-sheet">
  <view class="edit-header">收费管理</view>
  <view class="edit-field">
    <text class="edit-label">昵称</text>
    <text class="edit-value">{{feeForm.showName}}</text>
  </view>
  <view class="edit-field">
    <text class="edit-label">付款状态</text>
    <view class="edit-gender-options">
      <view
        class="edit-gender-option {{feeForm.payed === 'n' ? 'active' : ''}}"
        data-value="n"
        bindtap="handlePayStatusSelect"
      >未付款</view>
      <view
        class="edit-gender-option {{feeForm.payed === 'y' ? 'active' : ''}}"
        data-value="y"
        bindtap="handlePayStatusSelect"
      >已付款</view>
    </view>
  </view>
  <view class="edit-field">
    <text class="edit-label">付款金额</text>
    <input
      class="edit-input"
      value="{{feeForm.payMoney == null ? '' : feeForm.payMoney}}"
      placeholder="请输入付款金额"
      disabled="{{feeForm.payed !== 'y'}}"
      bindinput="handlePayMoneyInput"
    />
  </view>
  <view class="edit-actions">
    <view class="edit-action cancel" bindtap="handleFeeCancel">取消</view>
    <view class="edit-action confirm" bindtap="handleFeeConfirm">确定</view>
  </view>
</view>
