<CustomNavBar title="{{gameType === 'single_team' ? '队内赛' : '队际赛'}}" bind:back="handleBack" />

<view class="page-container" style="padding-top: {{navBarHeight}}px;">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 主内容 -->
  <block wx:else>
    <!-- 围观人数 -->
    <SpectatorBar
      count="{{spectators.count}}"
      spectators="{{spectators.avatars}}"
      bind:more="onSpectatorMore"
    />

    <!-- Tab 切换区域 -->
    <view class="tabs-container">
      <view
        wx:for="{{tabs}}"
        wx:key="index"
        class="tab-item {{currentTab === index ? 'active' : ''}}"
        data-index="{{index}}"
        bindtap="switchTab"
      >
        <text>{{item}}</text>
        <view wx:if="{{currentTab === index}}" class="tab-indicator"></view>
      </view>
    </view>

    <!-- Tab 内容区域 -->
    <scroll-view class="tab-content" scroll-y enhanced show-scrollbar="{{false}}">
      <!-- 赛事详情 Tab -->
      <view wx:if="{{currentTab === 0}}" class="tab-panel">
        <EventDetailTab
          isRegistered="{{isRegistered}}"
          bind:onShare="onShareTap"
          bind:onCancelRegister="onCancelRegister"
          bind:onSubmitRegister="onSubmitRegister"
          bind:onActionTap="onActionTap"
        />
      </view>

      <!-- 报名人员 Tab -->
      <view wx:if="{{currentTab === 1}}" class="tab-panel">
        <RegistrationTab />
      </view>

      <!-- 分组 Tab -->
      <view wx:if="{{currentTab === 2}}" class="tab-panel">
        <GroupsTab
          showHint="{{showGroupHint}}"
          bind:onGroupTap="onGroupTap"
          bind:onAddPlayer="onAddPlayerToGroup"
        />
      </view>

      <!-- 讨论区 Tab -->
      <view wx:if="{{currentTab === 3}}" class="tab-panel">
        <DiscussionTab />
      </view>
    </scroll-view>
  </block>
</view>
