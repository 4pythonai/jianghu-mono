<view class="container">
  <CustomNavBar title="{{mode === 'manage' ? '队员管理' : '队员列表'}}" showBack="{{true}}" />

  <view class="page-content" style="padding-top: {{navBarHeight}}px;">
    <!-- 加载中 -->
    <view class="loading-container" wx:if="{{loading}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">加载中...</text>
    </view>

    <!-- 成员列表 -->
    <view class="member-list" wx:else>
      <!-- 统计信息 -->
      <view class="stats-bar">
        <text class="stats-text">共 {{members.length}} 名成员</text>
      </view>

      <!-- 空状态 -->
      <view class="empty-state" wx:if="{{members.length === 0}}">
        <image class="empty-icon" src="/assets/icons/icons8-team-48.png" mode="aspectFit"></image>
        <text class="empty-text">暂无成员</text>
      </view>

      <!-- 成员卡片 -->
      <view class="member-card" wx:for="{{members}}" wx:key="user_id">
        <view class="member-avatar-wrap">
          <PlayerAvatar
            avatar="{{item.avatar}}"
            userId="{{item.user_id}}"
            avatarOnly="{{true}}"
            size="medium"
          />
        </view>
        <view class="member-info">
          <view class="member-name">{{item.display_name || '未设置昵称'}}</view>
          <view class="member-meta">
            <text
              class="member-handicap"
              wx:if="{{item.handicap !== null && item.handicap !== undefined}}"
            >差点 {{item.handicap}}</text>
            <text class="member-join-time">{{item.join_time_display}}</text>
          </view>
        </view>
        <view class="member-role">
          <text wx:if="{{item.role === 'SuperAdmin'}}" class="role-tag team-superadmin">超级管理员</text>
          <text wx:elif="{{item.role === 'admin'}}" class="role-tag admin">管理员</text>
          <text wx:else class="role-tag member">成员</text>
        </view>
        <!-- 管理模式下显示移除按钮 -->
        <view
          class="remove-btn"
          wx:if="{{mode === 'manage' && item.role !== 'SuperAdmin'}}"
          catchtap="onRemoveMember"
          data-user-id="{{item.user_id}}"
          data-shown-name="{{item.display_name}}"
        >
          <text>移除</text>
        </view>
      </view>
    </view>
  </view>
</view>
