<view class="container">
  <CustomNavBar title="邀请队员" showBack="{{true}}" />

  <view class="page-content" style="padding-top: {{navBarHeight}}px;">
    <!-- 搜索栏 -->
    <view class="search-bar">
      <image class="search-icon" src="/assets/icons/search.png" mode="aspectFit"></image>
      <input
        class="search-input"
        placeholder="搜索昵称或手机号"
        bindinput="onSearchInput"
        bindconfirm="onSearch"
        value="{{keyword}}"
        confirm-type="search"
      />
      <view class="search-btn" bindtap="onSearch" wx:if="{{keyword}}">
        <text>搜索</text>
      </view>
    </view>

    <!-- 搜索中 -->
    <view class="loading-container" wx:if="{{searching}}">
      <view class="loading-spinner"></view>
      <text class="loading-text">搜索中...</text>
    </view>

    <!-- 搜索结果 -->
    <view class="result-section" wx:elif="{{hasSearched}}">
      <!-- 空结果 -->
      <view class="empty-state" wx:if="{{users.length === 0}}">
        <image class="empty-icon" src="/assets/icons/icons8-search-48.png" mode="aspectFit"></image>
        <text class="empty-text">未找到相关用户</text>
        <text class="empty-hint">请尝试其他关键词</text>
      </view>

      <!-- 用户列表 -->
      <view class="user-list" wx:else>
        <view class="user-card" wx:for="{{users}}" wx:key="id">
          <view class="user-avatar-wrap">
            <jh-avatar
              avatar="{{item.avatar}}"
              user_id="{{item.id}}"
              avatar_only="{{true}}"
              size="medium"
            />
          </view>
          <view class="user-info">
            <view class="user-name">{{item.show_name || '未设置昵称'}}</view>
            <view class="user-meta">
              <text
                class="user-handicap"
                wx:if="{{item.handicap !== null && item.handicap !== undefined}}"
              >差点 {{item.handicap}}</text>
              <text class="user-mobile" wx:if="{{item.mobile_display}}">{{item.mobile_display}}</text>
            </view>
          </view>
          <view
            class="invite-btn {{item.inviting ? 'disabled' : ''}}"
            catchtap="onInvite"
            data-user-id="{{item.id}}"
            data-shown-name="{{item.show_name}}"
            data-index="{{index}}"
          >
            <text>{{item.inviting ? '邀请中...' : '邀请'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 初始状态提示 -->
    <view class="hint-section" wx:else>
      <image class="hint-icon" src="/assets/icons/icons8-search-48.png" mode="aspectFit"></image>
      <text class="hint-text">输入昵称或手机号搜索用户</text>
    </view>
  </view>
</view>
