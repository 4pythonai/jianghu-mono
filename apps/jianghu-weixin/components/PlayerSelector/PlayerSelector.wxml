<view class="player-selector">
  <view class="group-header">
    <text class="group-title">第{{groupIndex + 1}}组</text>
    <view class="player-count">{{validPlayerCount}}/{{maxPlayers}}人</view>
  </view>
  <view class="players-list">
    <view class="player-slot" wx:for="{{ playerSlots }}" wx:key="index">
      <!-- 已选择的玩家 -->
      <view wx:if="{{ item }}" class="player-card">
        <view class="player-avatar">
          <PlayerAvatar
            avatar="{{item.avatar}}"
            userId="{{item.user_id}}"
            avatarOnly="{{true}}"
            size="medium"
          />
        </view>
        <view class="player-info">
          <!-- 统一使用 show_name 字段（后端计算的显示名称） -->
          <text class="player-nickname">{{item.show_name}}</text>
          <text class="player-id">ID: {{item.user_id}}</text>
          <text class="player-source">来源: {{joinTypeMap[item.join_type] || '未知来源'}}</text>
        </view>
        <view class="remove-btn" bindtap="removePlayer" data-index="{{ index }}">
          <image src="/assets/icons/close.svg" mode="aspectFit"></image>
        </view>
      </view>
      <!-- 空位 - 显示添加按钮 -->
      <view wx:else class="empty-slot" bindtap="onSelectPlayer" data-index="{{ index }}">
        <view class="add-player-btn">
          <image src="/assets/icons/add.svg" class="add-icon" mode="aspectFit"></image>
          <text class="add-text">添加玩家{{index + 1}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
