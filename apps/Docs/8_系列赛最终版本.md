# 一、核心实体定义
## 组织机构 (Organization)
| 项目 | 说明 |
| --- | --- |
| 定义 | 开放性的赛事组织者，面向公众招募参赛者 |
| 与球队区别 | 球队是封闭圈子（面向队员），组织机构是开放平台（公开招募） |
| 创建权限 | 任何用户都可以创建 |
| 成员体系 | 有成员/管理员体系，类似球队 |
| 多归属 | 一个用户可以同时是多个组织机构的成员/管理员 |
| 特殊属性 | 未来支持"V认证"功能，认证后具备官方权威性 |
| 创建方式 | 创建系列赛时输入组织机构名称，系统模糊匹配；无匹配则自动创建新组织机构 |


## 球队 (Team)
| 项目 | 说明 |
| --- | --- |
| 定义 | 封闭性的球员组织，面向队员组织赛事 |
| 现有表 | `t_team` |
| 创建方式 | 创建赛事时输入球队名称，系统模糊匹配；无匹配则提示上传LOGO完成简单创建 |


## TAG /标签(也被称为分队)
| 项目 | 说明 |
| --- | --- |
| 定义 | 队内/队际赛中的标签,用于对参加人员进行逻辑分组 |
| 现有表 | `t_team_game_tags` |
| 注意 | 组织机构创建的系列赛中，所有球队都必须是真实的 `t_team` |


<font style="color:#df2a3f;">为防止"分队"与"球队"混淆,该称TAG/标签</font>



## 比赛类型/game_type
+ 比赛类型: common(普通比赛),来自于"普通创建","快速创建"
+ single_team(队内赛),来自于"队内赛"
+ cross_teams(队际赛),来自于"队际赛"

# 二、系列赛体系
## 总体定义
**系列赛**是两场或以上game的集合，每个都被称为"子赛","子赛"之间的数据具有关联性，系统按设定规则进行统计汇总并展示。

## 系列赛类型
| 类型 | 组织者 | 参赛单位 | 赛制限制 |
| --- | --- | --- | --- |
| 系列队际赛 | 组织机构 | 球队 | 仅比杆赛 |
| 系列队内赛 | 球队 | 球队成员（可分队） | 仅比杆赛 |
| 系列个人赛 | 组织机构 | 个人 | 仅比杆赛 |
| 莱德杯 | 组织机构 | 球队（仅2队） | 仅比洞赛 |


## 关键约束
+ **赛制一致性**：同一系列赛内，所有"子赛"要么全是比杆赛，要么全是比洞赛，不可混合
+ **系统校验**：违反赛制一致性的"子赛"无法创建成功

---

# 三、系列队际赛(比杆)
## 定义
由组织机构发起，多支球队参与的系列比杆赛。

## 统计规则
创建时选择以下两种规则之一：

| 规则 | 名称 | N值设定 | 说明 |
| --- | --- | --- | --- |
| A | 全局取前N名 | 创建时输入一次 | 每支球队所有场次的参赛球员（或组合）中，取成绩最好的前N名进行汇总 |
| B | 每场取前N名后汇总 | 每场单独设定（可统一默认值） | 关于B，准确描述为：第一场取前N1名，第二场取前N2名。。。。。第T场取前NT名。最后按照（N1+N2+....NT)成绩汇总。 |


**N值管理**：

+ 规则A：创建时设定一次，后续可由管理员修改
+ 规则B：默认统一值应用到所有"子赛"，创建者可单独修改某场的N值
+ 所有N值在赛事创建后均可由管理员修改保存

## 球员归属规则
| 规则 | 说明 |
| --- | --- |
| 多场成绩计入 | 同一球员参加多场比赛，所有成绩均计入统计 |
| 球队归属唯一 | 同一球员在同一系列赛中，不可代表不同球队 |
| 校验时机 | 球员报名"子赛"时即校验 |
| 冲突处理 | 发现冲突则阻止报名 |


---

# 四、系列队内赛（月例赛）(比杆)
## 定义
由球队发起的队内系列比杆赛，典型场景是年度月例赛。

## 核心参数
| 参数 | 含义 | 说明 |
| --- | --- | --- |
| T | 总场次 | 系列赛包含的"子赛"数量（可边打边加） |
| N | 最低参赛场次 | 参加满N场及以上才能参加年度评选 |
| M | 取最佳场次数 | 取最好的M场成绩作为排名依据（M ≤ N） |


**参数管理**：

+ 创建时设定
+ 后续可由管理员修改保存
+ 不限定自然年度，仅针对系列赛内所有"子赛"计算

## TAG规则
| 规则 | 说明 |
| --- | --- |
| TAG创建 | 创建者可选择是否创建TAG |
| 一致性要求 | 一旦创建TAG，所有"子赛"必须全部采用该TAG设置 |
| 新球员加入 | 必须选择已有TAG，不可创建新TAG，不可无TAG |
| 归属唯一 | 同一球员在同一系列赛中不可更换TAG |


---

# 五、系列个人赛(比杆)
## 定义
由组织机构发起的个人系列比杆赛，参赛者以N场成绩总和排名。

## 核心规则
| 项目 | 说明 |
| --- | --- |
| 报名名单 | 报名时应将名单应用到本系列赛所有"子赛" |
| 球队归属 | 不涉及，都是独立个体 |


## 晋级线（待细化）
| 项目 | 说明 |
| --- | --- |
| 设置 | 由管理员在前X场后设定晋级人数（具体实现待定） |
| 未晋级球员 | 默认保留在名单中，管理员可手动删除 |


---

# 六、莱德杯(比洞)
## 定义
两支球队之间的系列比洞赛，参考职业莱德杯赛制。

## 核心规则
| 项目 | 说明 |
| --- | --- |
| 参赛队伍 | 仅限2支球队 |
| "子赛"数量 | 默认3场，管理员可配置为2场或其他 |
| "子赛"赛制 | 默认为"四人四球比洞+四人两球比洞+个人比洞"，可在比洞赛类型内修改 |
| 赛制限制 | 所有"子赛"必须是比洞赛类型 |


## 积分规则
| 结果 | 积分 |
| --- | --- |
| 组内对抗获胜 | 1分 |
| 组内对抗落败 | 0分 |
| 组内对抗平局 | 各0.5分 |


**展示要求**：

+ 实时展示两队总积分
+ 展示每一组的具体战况
+ 参考美国队 vs 欧洲队莱德杯战况页面设计

---

# 七、系列赛生命周期
## 状态定义
| 状态 | 说明 |
| --- | --- |
| 未开始 | 系列赛已创建，尚无"子赛"开始 |
| 进行中 | 至少一场"子赛"已开始或进行中 |
| 已结束 | 所有"子赛"全部完成，或管理员手动标记结束 |


## "子赛"管理
| 项目 | 说明 |
| --- | --- |
| 添加时机 | 可边打边加，无需预先定义所有"子赛" |
| 独立赛事并入 | 现阶段不支持 |
| 结构 | "子赛"与普通单场赛事结构一致，通过 series_id 关联 |


## 排序规则
在广场展示时，以正在进行的"子赛"时间作为排序依据。

---

# 八、创建入口
## 主入口
```plain
主菜单中间按钮
  ├── 快捷创建（现有功能）
  ├── 普通创建（现有功能）
  └── 更多创建
        ├── 创建队内赛
        ├── 创建队际赛
        └── 创建系列赛
              ├── 系列队际赛
              ├── 系列队内赛
              ├── 系列个人赛
              └── 莱德杯赛
```

## 其他入口
待讨论

---

# 九、待定事项
| 事项 | 说明 |
| --- | --- |
| 组织机构特殊属性 | 除V认证外，其他属性待了解实际需求后增加 |
| 组织机构页面设计 | 是否有详情页、展示哪些内容待定 |
| 系列个人赛晋级线实现 | 手动/自动、具体交互待定 |
| 系列赛UI展示 | 与普通赛事的区分展示方式待定 |
| 其他创建入口 | 除主菜单外的入口位置待讨论 |


---

# 十、数据模型建议（初步）
## 新增表
| 表名 | 说明 |
| --- | --- |
| `t_organization` | 组织机构 |
| `t_organization_member` | 组织机构成员 |
| `t_series` | 系列赛主表 |
| `t_series_team` | 系列赛参赛球队（系列队际赛/莱德杯用） |
| `t_series_subteam` | 系列赛分队（系列队内赛用） |


## 现有表修改
| 表名 | 修改 |
| --- | --- |
| `t_game` | 增加 `series_id` 外键，关联所属系列赛 |


---

_文档版本：2026-01-10 澄清讨论整理_

